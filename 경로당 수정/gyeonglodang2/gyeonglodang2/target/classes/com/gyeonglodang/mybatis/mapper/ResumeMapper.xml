<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.gyeonglodang.mybatis.mapper.ResumeMapper">

<insert id="insertPersonal" parameterType="personalDTO">
	insert into personal(gonggoidx, personalTitle, personalField, personalNotice)
	values (#{gonggoIdx},#{personalTitle}, #{personalField}, #{personalNotice})
</insert>

<delete id="deletePersonal" parameterType="personalDTO">
    delete from Personal
    where gonggoidx = #{gonggoIdx}
</delete> 

<select id="getPersonalIdx" parameterType="personalDTO" resultType="personalDTO">
<![CDATA[
select idx from personal where gonggoidx = #{gonggoIdx} and personalTitle = #{personalTitle}
]]>
</select>

<insert id="insertPersonalQ" parameterType="personalQDTO">
	insert into personalQ(personalIdx, personalQuestion, personalMinW, personalMaxW)
	values (#{personalIdx},#{personalQuestion}, #{personalMinW}, #{personalMaxW})
</insert>

<delete id="deletePersonalQ" parameterType="personalDTO">
    delete from PersonalQ
    where personalidx = (select idx from personal where gonggoidx = #{gonggoIdx})
</delete> 

<insert id="insertCareer" parameterType="careerDTO">
	insert into career(gonggoidx, careerTitle, careerField, careerNotice)
	values (#{gonggoIdx},#{careerTitle}, #{careerField}, #{careerNotice})
</insert>

<delete id="deleteCareer" parameterType="careerDTO">
    delete from Career
    where gonggoidx = #{gonggoIdx}
</delete> 

<select id="getCareerIdx" parameterType="careerDTO" resultType="careerDTO">
<![CDATA[
select idx from career where gonggoidx = #{gonggoIdx} and careerTitle = #{careerTitle}
]]>
</select>

<insert id="insertCareerQ" parameterType="careerQDTO">
	insert into careerQ(careeridx, careerQuestion, careerMinW, careerMaxW)
	values (#{careerIdx},#{careerQuestion}, #{careerMinW}, #{careerMaxW})
</insert>

<delete id="deleteCareerQ" parameterType="careerDTO">
    delete from CareerQ
    where careeridx = (select idx from career where gonggoidx = #{gonggoIdx})
</delete> 

 <insert id="insertInfo" parameterType="infoDTO">
	insert into info(gonggoidx, infoTitle, infoNotice, infoName, infoBirth, infoAddress, infoPhone, infoArmy, infoVulnerable, infoYouth, infoDisabled)
	values (#{gonggoIdx}, #{infoTitle}, #{infoNotice}, #{infoName}, #{infoBirth}, #{infoAddress}, #{infoPhone}, #{infoArmy}, #{infoVulnerable}, #{infoYouth}, #{infoDisabled})
</insert>

<delete id="deleteInfo" parameterType="infoDTO">
    delete from info
    where gonggoidx = #{gonggoIdx}
</delete> 

<insert id="insertInfoCustom" parameterType="infoCustomDTO">
	insert into infoCustom(gonggoidx, infoCustomCategory, infoCustomNotice, infoCustomField, infocustomPilsu)
	values (#{gonggoIdx}, #{infoCustomCategory}, #{infoCustomNotice}, #{infoCustomField}, #{infoCustomPilsu})
</insert>

<delete id="deleteInfoCustom" parameterType="infoCustomDTO">
    delete from infoCustom
    where gonggoidx = #{gonggoIdx}
</delete> 

<insert id="insertResumeCustom" parameterType="resumeCustomDTO" useGeneratedKeys="true" keyProperty="idx">
	insert into resumeCustom(gonggoidx, customTitle, customField, customNotice)
	values (#{gonggoIdx}, #{customTitle}, #{customField}, #{customNotice})
</insert>

<delete id="deleteResumeCustom" parameterType="resumeCustomDTO">
    delete from resumeCustom where gonggoidx = #{gonggoIdx}
</delete> 

<select id="getResumeCustomIdx" parameterType="resumeCustomDTO" resultType="resumeCustomDTO">
<![CDATA[
select idx from ResumeCustom where gonggoidx = #{gonggoIdx} and customTitle = #{customTitle}
]]>
</select>

<insert id="insertSentenceType" parameterType="sentenceTypeDTO">
	insert into SentenceType (resumeCustomidx, sentenceQuestion, sentenceNotice, sentencePilsu)
	values (#{resumeCustomIdx}, #{sentenceQuestion}, #{sentenceNotice}, #{sentencePilsu})
</insert>

<delete id="deleteSenteceType" parameterType="sentenceTypeDTO">
    delete from SentenceType
    where resumeCustomidx = #{resumeCustomIdx}
</delete> 

<insert id="insertTableType" parameterType="tableTypeDTO" useGeneratedKeys="true" keyProperty="idx">
	insert into TableType (resumeCustomidx, tableTitle, tableMinRow, tableMaxRow, tableMaxCol)
	values (#{resumeCustomIdx}, #{tableTitle}, #{tableMinRow}, #{tableMaxRow}, #{tableMaxCol})
</insert>

<delete id="deleteTableType" parameterType="tableTypeDTO">
	delete from TableType
	where resumeCustomidx = #{resumeCustomIdx}
</delete>

<select id="getTableTypeIdx" parameterType="tableTypeDTO" resultType="tableTypeDTO">
<![CDATA[
select idx from tableType where resumeCustomidx = #{resumeCustomIdx} and tabletitle = #{tableTitle}
]]>
</select>

<insert id="insertTableTypeQ" parameterType="tableTypeQDTO">
	insert into TableTypeQ (tableTypeIdx, tableCategory, tableNotice)
	values (#{tableTypeIdx}, #{tableCategory}, #{tableNotice})
</insert>

<delete id="deleteTableTypeQ" parameterType="tableTypeQDTO">
	delete from TableTypeQ
	where tableTypeidx = #{tableTypeIdx}
</delete>

<insert id="insertResumeFileUpload" parameterType="resumeFileUploadSetDTO">
	insert into rsmfileupload_table (rsmfile_idx, rsmfileupload_field, rsmfileupload_fileName, rsmfileupload_original, rsmfileupload_pilsu, rsmfileupload_filePath)
	values(#{rsmfile_idx}, #{rsmfileupload_field}, #{rsmfileupload_fileName}, #{rsmfileupload_original}, #{rsmfileupload_pilsu}, #{rsmfileupload_filePath})
</insert>

<delete id="deleteResumeFileUpload" parameterType="resumeFileDTO">
	delete from rsmfileupload_table where rsmfile_idx in (select rsmfile_idx from rsmfile where gonggoidx = #{gonggoIdx})
</delete>

<insert id="insertResumeFile" parameterType="resumeFileDTO">
	insert into rsmfile (gonggoidx, rsmfile_title,rsmfile_explain) values(#{gonggoIdx}, #{rsmfile_title},#{rsmfile_explain});
</insert>

<delete id="deleteResumeFile" parameterType = "resumeFileDTO">
	delete from rsmfile where gonggoidx = #{gonggoIdx}
</delete>

<select id="getResumeFileIdx" parameterType= "resumeFileDTO" resultType="int">
	<![CDATA[
		select rsmfile_idx from rsmfile where gonggoidx = #{gonggoIdx};
	]]>
</select>

<!-- 여기서부터 불러오는 mapper -->

<select id="getInfo" parameterType="infoDTO" resultType="infoDTO"> 
	select * from info where gonggoidx = #{gonggoIdx}
</select>

<select id="getInfoCustom" parameterType="infoCustomDTO" resultType="infoCustomDTO">
	select * from infoCustom where gonggoidx = #{gonggoIdx}
</select>

<select id="getPersonal" parameterType="personalDTO" resultType="personalDTO">
	select * from personal where gonggoidx = #{gonggoIdx}
</select>

<select id="getPersonalQ" parameterType="personalDTO" resultType="personalQDTO">
	select * from personalq where personalidx = (select idx from personal where gonggoidx=#{gonggoIdx})
</select>

<select id="getCareer" parameterType="careerDTO" resultType="careerDTO">
	select * from career where gonggoidx = #{gonggoIdx}
</select>

<select id="getCareerQ" parameterType="careerDTO" resultType="careerQDTO">
	select * from careerq where careeridx = (select idx from career where gonggoidx = #{gonggoIdx})
</select>

<select id="getResumeCustom" parameterType="resumeCustomDTO" resultType="resumeCustomDTO">
	select * from resumecustom where gonggoidx = #{gonggoIdx}
</select>

<select id="getSentenceType" parameterType="resumeCustomDTO" resultType="sentenceTypeDTO">
	select * from sentenceType where resumecustomidx in (select idx from resumecustom where gonggoidx=#{gonggoIdx})
</select>

<select id="getTableType" parameterType="resumeCustomDTO" resultType="tableTypeDTO">
	select * from tableType where resumecustomidx in (select idx from resumecustom where gonggoidx=#{gonggoIdx})
</select>

<select id="getTableTypeQ" parameterType="resumeCustomDTO" resultType="tableTypeQDTO">
	select * from tableTypeQ where tableTypeidx in (select idx from tableType where resumecustomidx in (select idx from resumecustom where gonggoidx=#{gonggoIdx}))
</select>

<select id="getResumeFile" parameterType="resumeFileDTO" resultType="resumeFileDTO">
	select * from rsmfile where gonggoidx = #{gonggoIdx}
</select>

<select id="getResumeFileUpload" parameterType="resumeFileDTO" resultType="resumeFileUploadSetDTO">
	select * from rsmfileupload_table where rsmfile_idx in (select rsmfile_idx from rsmfile where gonggoidx = #{gonggoIdx})
</select>

<!-- 여기서부터 채용분야 별 지원서 정보 불러오는 mapper -->

<select id="getInfoCustomField" parameterType="infoCustomDTO" resultType="infoCustomDTO">
	select * from infoCustom where gonggoidx = #{gonggoIdx} and infoCustomField = 1
</select>

<select id="getInfoCustomFieldSetting" parameterType="infoCustomFieldSettingDTO" resultType="infoCustomFieldSettingDTO">
	select * from infoCustomFieldSetting where noticeControl_idx = #{noticeControl_idx}
</select>

<select id="getPersonalField" parameterType="personalDTO" resultType="personalDTO">
	select * from personal where gonggoidx = #{gonggoIdx} and personalField = 1
</select>

<select id="getPersonalFieldSetting" parameterType="personalFieldSettingDTO" resultType="personalFieldSettingDTO">
	select * from personalFieldSetting where noticeControl_idx =#{noticeControl_idx}
</select>

<select id="getCareerField" parameterType="careerDTO" resultType="careerDTO">
	select * from career where gonggoidx = #{gonggoIdx} and careerField = 1
</select>

<select id="getCareerFieldSetting" parameterType="careerFieldSettingDTO" resultType="careerFieldSettingDTO">
	select * from careerFieldSetting where noticeControl_idx= #{noticeControl_idx}
</select>

<select id="getResumeCustomField" parameterType="resumeCustomDTO" resultType="resumeCustomDTO">
	select * from resumeCustom where gonggoidx = #{gonggoIdx} and customField = 1
</select>

<select id = "getResumeCustomFieldSetting" parameterType="customFieldSettingDTO" resultType="customFieldSettingDTO">
	select * from customFieldSetting where noticeControl_idx = #{noticeControl_idx}
</select>

<select id="getResumeFileUploadField" parameterType="resumeFileDTO" resultType="resumeFileUploadSetDTO">
	select * from rsmfileupload_table where rsmfile_idx in (select rsmfile_idx from rsmfile where gonggoidx = #{gonggoIdx}) and rsmfileupload_field = 1
</select>

<select id = "getResumeFileUploadFieldSetting" parameterType="rsmFileUploadFieldSettingDTO" resultType="rsmFileUploadFieldSettingDTO">
	select * from rsmFileUploadFieldSetting where noticeControl_idx = #{noticeControl_idx}
</select>

<select id="getRecruitField" parameterType="recruitCategBoardDTO" resultType="recruitCategBoardDTO">
	select recruitCateg_categ from recruitcateg_board where noticeControl_idx = #{gonggoIdx}
</select>

<!-- 여기서부터 채용분야 별 지원서 정보 삽입하는 mapper -->
<insert id="insertInfoCustomField" parameterType="infoCustomFieldSettingDTO">
	insert into infoCustomFieldSetting (noticeControl_idx, infoCustomField, infoCustomField_idx) 
	values (#{noticeControl_idx}, #{infoCustomField}, #{infoCustomField_idx})
</insert>

<delete id="deleteInfoCustomField" parameterType="infoCustomFieldSettingDTO">
	delete from infoCustomFieldSetting where noticeControl_idx = #{noticeControl_idx}
</delete>

<insert id="insertCustomField" parameterType="customFieldSettingDTO">
	insert into customFieldSetting (noticeControl_idx, customField, customField_idx)
	values (#{noticeControl_idx}, #{customField}, #{customField_idx})
</insert>

<delete id="deleteCustomField" parameterType="customFieldSettingDTO">
	delete from customFieldSetting where noticeControl_idx = #{noticeControl_idx}
</delete>

<insert id="insertPersonalField" parameterType="personalFieldSettingDTO">
	insert into personalFieldSetting (noticeControl_idx, personalField, personalField_idx)
	values (#{noticeControl_idx}, #{personalField}, #{personalField_idx})
</insert>

<delete id="deletePersonalField" parameterType="personalFieldSettingDTO">
	delete from personalFieldSetting where noticeControl_idx = #{noticeControl_idx}
</delete>

<insert id="insertCareerField" parameterType="careerFieldSettingDTO">
	insert into careerFieldSetting (noticeControl_idx, careerField, careerField_idx)
	values (#{noticeControl_idx}, #{careerField}, #{careerField_idx})
</insert>

<delete id="deleteCareerField" parameterType="careerFieldSettingDTO">
	delete from careerFieldSetting where noticeControl_idx = #{noticeControl_idx}
</delete>

<insert id="insertRsmFileUploadField" parameterType="rsmFileUploadFieldSettingDTO">
	insert into rsmfileuploadfieldsetting (noticeControl_idx, fileField, rsmfileupload_Field_idx)
	values (#{noticeControl_idx}, #{fileField}, #{rsmfileupload_field_idx})
</insert>

<delete id="deleteRsmFileUploadField" parameterType="rsmFileUploadFieldSettingDTO">
	delete from rsmfileuploadfieldsetting where noticeControl_idx = #{noticeControl_idx}
</delete>

</mapper>